<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>FinMemory - Arquivos para Lovable</title>
  <style>
    * { box-sizing: border-box; }
    body { 
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      line-height: 1.6;
      color: #333;
      max-width: 900px;
      margin: 0 auto;
      padding: 40px 24px;
      font-size: 14px;
    }
    h1 { 
      font-size: 28px; 
      color: #667eea;
      border-bottom: 3px solid #667eea;
      padding-bottom: 8px;
      margin-top: 0;
    }
    h2 { 
      font-size: 20px; 
      color: #764ba2;
      margin-top: 40px;
      page-break-before: always;
    }
    h2:first-of-type { page-break-before: avoid; }
    h3 { font-size: 16px; color: #555; margin-top: 24px; }
    pre { 
      background: #f8f9fa; 
      border: 1px solid #e5e7eb;
      border-radius: 8px;
      padding: 16px;
      overflow-x: auto;
      font-size: 12px;
      line-height: 1.5;
      white-space: pre-wrap;
      word-wrap: break-word;
    }
    .file-path { 
      background: #e7f3ff; 
      padding: 8px 12px; 
      border-radius: 6px;
      font-family: monospace;
      font-size: 13px;
      margin-bottom: 12px;
    }
    .section { margin-bottom: 32px; }
    ul { padding-left: 20px; }
    table { border-collapse: collapse; width: 100%; margin: 16px 0; }
    th, td { border: 1px solid #ddd; padding: 10px; text-align: left; }
    th { background: #f8f9fa; font-weight: 600; }
    .page-break { page-break-after: always; }
    @media print {
      body { padding: 20px; }
      h2 { page-break-before: always; }
      h2:first-of-type { page-break-before: avoid; }
    }
  </style>
</head>
<body>
  <h1>FinMemory - Resumo e Arquivos para Lovable</h1>
  <p><strong>Projeto:</strong> Assistente financeiro que organiza notas fiscais (Gmail + OCR por foto)</p>
  <p><strong>Stack atual:</strong> Next.js 14, React, Supabase, NextAuth, OpenAI GPT-4 Vision</p>
  <p><strong>Estilos:</strong> Inline (sem Tailwind)</p>

  <div class="section">
    <h2>1. Resumo para Lovable (LOVABLE-LAYOUT-RESUMO.md)</h2>
    <h3>Estrutura de Arquivos</h3>
    <pre>pages/
‚îú‚îÄ‚îÄ index.js          ‚Üí Landing + bot√£o "Entrar com Google"
‚îú‚îÄ‚îÄ dashboard.js      ‚Üí Dashboard principal (transa√ß√µes, sync Gmail, bot√£o OCR)
‚îú‚îÄ‚îÄ add-receipt.js    ‚Üí Captura de nota fiscal via foto (OCR)
‚îú‚îÄ‚îÄ login.js          ‚Üí M√≠nimo (pouco usado)
‚îú‚îÄ‚îÄ _app.js           ‚Üí SessionProvider (NextAuth)
‚îî‚îÄ‚îÄ api/
    ‚îú‚îÄ‚îÄ auth/[...nextauth].js   ‚Üí Google OAuth
    ‚îú‚îÄ‚îÄ gmail/sync.js           ‚Üí Sincronizar emails do Gmail
    ‚îî‚îÄ‚îÄ ocr/
        ‚îú‚îÄ‚îÄ process-receipt.js  ‚Üí Processar imagem com GPT-4 Vision
        ‚îî‚îÄ‚îÄ save-transaction.js ‚Üí Salvar transa√ß√£o confirmada</pre>

    <h3>Design System</h3>
    <ul>
      <li>Gradiente roxo: linear-gradient(135deg, #667eea 0%, #764ba2 100%)</li>
      <li>Bot√£o Google: #34A853</li>
      <li>Background claro: #f8f9fa</li>
      <li>Fonte: system-ui, -apple-system, sans-serif</li>
    </ul>

    <h3>APIs</h3>
    <table>
      <tr><th>Rota</th><th>M√©todo</th><th>Body</th></tr>
      <tr><td>/api/gmail/sync</td><td>POST</td><td>{ userId, firstSync }</td></tr>
      <tr><td>/api/ocr/process-receipt</td><td>POST</td><td>{ imageBase64, userId }</td></tr>
      <tr><td>/api/ocr/save-transaction</td><td>POST</td><td>{ userId, merchant_name, total_amount, ... }</td></tr>
    </table>

    <h3>Supabase - Tabelas</h3>
    <ul>
      <li>users: id, email, name, google_id, access_token, refresh_token, token_expiry, last_sync</li>
      <li>transacoes: id, user_id, estabelecimento, cnpj, data, total, source, receipt_image_url, items, categoria</li>
      <li>produtos: id, transacao_id, descricao, quantidade, valor_unitario, valor_total</li>
    </ul>
  </div>

  <div class="page-break"></div>

  <h2>2. pages/_app.js</h2>
  <div class="file-path">pages/_app.js</div>
  <pre>import { SessionProvider } from 'next-auth/react';

export default function App({ Component, pageProps: { session, ...pageProps } }) {
  return (
    &lt;SessionProvider session={session}&gt;
      &lt;Component {...pageProps} /&gt;
    &lt;/SessionProvider&gt;
  );
}</pre>

  <div class="page-break"></div>

  <h2>3. pages/index.js</h2>
  <div class="file-path">pages/index.js</div>
  <pre>import { useSession, signIn } from 'next-auth/react';
import { useEffect } from 'react';
import { useRouter } from 'next/router';

export default function Home() {
  const { data: session, status } = useSession();
  const router = useRouter();

  useEffect(() => {
    if (status === 'authenticated') {
      router.push('/dashboard?success=true');
    }
  }, [status, router]);

  const handleSignIn = () => {
    signIn('google', { callbackUrl: '/dashboard?success=true' });
  };

  if (status === 'loading') {
    return (
      &lt;div style={{ minHeight: '100vh', display: 'flex', alignItems: 'center', justifyContent: 'center',
        background: 'linear-gradient(135deg, #667eea 0%, #764ba2 100%)' }}&gt;
        &lt;div style={{ background: 'white', padding: '40px', borderRadius: '20px', textAlign: 'center' }}&gt;
          &lt;div style={{ fontSize: '48px', marginBottom: '16px' }}&gt;‚è≥&lt;/div&gt;
          &lt;p style={{ fontSize: '18px', color: '#666' }}&gt;Carregando...&lt;/p&gt;
        &lt;/div&gt;
      &lt;/div&gt;
    );
  }

  return (
    &lt;div style={{ minHeight: '100vh', display: 'flex', flexDirection: 'column', alignItems: 'center',
      justifyContent: 'center', padding: '50px', fontFamily: 'system-ui', 
      background: 'linear-gradient(135deg, #667eea 0%, #764ba2 100%)' }}&gt;
      &lt;div style={{ background: 'white', padding: '60px 40px', borderRadius: '20px',
        boxShadow: '0 20px 60px rgba(0,0,0,0.3)', textAlign: 'center', maxWidth: '600px', width: '100%' }}&gt;
        &lt;h1 style={{ fontSize: '48px', marginBottom: '20px', background: 'linear-gradient(135deg, #667eea, #764ba2)',
          WebkitBackgroundClip: 'text', WebkitTextFillColor: 'transparent', fontWeight: 'bold' }}&gt;
          üöÄ FinMemory
        &lt;/h1&gt;
        &lt;p style={{ fontSize: '20px', color: '#666', marginBottom: '40px', lineHeight: 1.6 }}&gt;
          Seu assistente financeiro inteligente que organiza suas notas fiscais automaticamente do Gmail
        &lt;/p&gt;
        &lt;div style={{ display: 'flex', flexDirection: 'column', gap: '16px', alignItems: 'center' }}&gt;
          &lt;button onClick={handleSignIn} style={{ display: 'flex', alignItems: 'center', gap: '12px',
            padding: '16px 40px', background: 'linear-gradient(135deg, #34A853, #0F9D58)', color: 'white',
            border: 'none', borderRadius: '8px', fontSize: '18px', fontWeight: 'bold', cursor: 'pointer',
            width: '100%', maxWidth: '400px' }}&gt;
            [SVG Google] Entrar com Google
          &lt;/button&gt;
          &lt;a href="/dashboard" style={{ padding: '14px 40px', color: '#667eea', border: '2px solid #667eea',
            borderRadius: '8px', textDecoration: 'none' }}&gt;Ver Dashboard&lt;/a&gt;
        &lt;/div&gt;
        &lt;div style={{ marginTop: '40px', padding: '24px', background: '#f8f9fa', borderRadius: '12px' }}&gt;
          &lt;h3&gt;‚ú® Como funciona:&lt;/h3&gt;
          &lt;ul&gt;
            &lt;li&gt;üìß Conecte seu Gmail&lt;/li&gt;
            &lt;li&gt;ü§ñ IA processa suas notas fiscais&lt;/li&gt;
            &lt;li&gt;üìä Visualize gastos organizados&lt;/li&gt;
            &lt;li&gt;üí∞ Controle total de suas finan√ßas&lt;/li&gt;
          &lt;/ul&gt;
        &lt;/div&gt;
      &lt;/div&gt;
    &lt;/div&gt;
  );
}</pre>

  <div class="page-break"></div>

  <h2>4. pages/dashboard.js</h2>
  <div class="file-path">pages/dashboard.js (resumido - ver arquivo completo no projeto)</div>
  <p><strong>Componentes principais:</strong></p>
  <ul>
    <li>Header com t√≠tulo FinMemory, nome do usu√°rio, bot√µes: Buscar Notas Fiscais, Ver Logs, Debug, Sair</li>
    <li>Menu: links Privacidade e Termos</li>
    <li>Painel de Debug (colaps√°vel)</li>
    <li>Painel de Logs da Sincroniza√ß√£o (colaps√°vel)</li>
    <li>Estado vazio: "Conecte seu Gmail" ou "Nenhuma nota fiscal encontrada"</li>
    <li>Lista de transa√ß√µes: TransactionCard com estabelecimento, data, valor, produtos expans√≠veis</li>
    <li>Bot√£o flutuante üì∏ (canto inferior direito) ‚Üí /add-receipt</li>
  </ul>
  <p><strong>Estados:</strong> transactions, loading, syncing, userId, syncLogs, lastSyncResult, showLogs</p>
  <p><strong>APIs usadas:</strong> Supabase (transacoes, users), /api/gmail/sync</p>
  <p><em>O arquivo completo tem ~1280 linhas. Abra pages/dashboard.js no projeto para o c√≥digo completo.</em></p>

  <div class="page-break"></div>

  <h2>5. pages/add-receipt.js</h2>
  <div class="file-path">pages/add-receipt.js (resumido - ver arquivo completo no projeto)</div>
  <p><strong>Fluxo em steps:</strong> CAPTURE ‚Üí PREVIEW ‚Üí PROCESSING ‚Üí EDIT ‚Üí SAVING ‚Üí SUCCESS</p>
  <ul>
    <li>CAPTURE: Bot√µes "Tirar Foto" e "Escolher da Galeria"</li>
    <li>PREVIEW: Imagem + "Processar Nota" / "Tirar Outra"</li>
    <li>PROCESSING: Spinner + "Lendo sua nota fiscal..."</li>
    <li>EDIT: Formul√°rio (estabelecimento, CNPJ, data, valor, categoria, pagamento, itens)</li>
    <li>SAVING: Spinner + "Salvando transa√ß√£o..."</li>
    <li>SUCCESS: "Nota fiscal salva!" + redirect para dashboard</li>
  </ul>
  <p><strong>APIs:</strong> /api/ocr/process-receipt, /api/ocr/save-transaction</p>
  <p><strong>Fun√ß√µes:</strong> compressImage(), handleFileSelect(), processImage(), saveTransaction()</p>
  <p><em>O arquivo completo tem ~835 linhas. Abra pages/add-receipt.js no projeto para o c√≥digo completo.</em></p>

  <div class="section" style="margin-top: 48px;">
    <h3>Como gerar o PDF</h3>
    <ol>
      <li>Abra este arquivo (FinMemory-Lovable-Arquivos.html) no navegador</li>
      <li>Pressione Ctrl+P (ou Cmd+P no Mac)</li>
      <li>Em "Destino" ou "Printer", escolha <strong>"Salvar como PDF"</strong> ou "Save as PDF"</li>
      <li>Clique em Salvar</li>
    </ol>
    <p><strong>Nota:</strong> Para incluir o c√≥digo completo de dashboard.js e add-receipt.js no PDF, voc√™ pode copiar e colar manualmente do projeto, ou abrir os arquivos no editor e imprimir cada um.</p>
  </div>
</body>
</html>
